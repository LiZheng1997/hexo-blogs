---
title: MachineLeaning-ChapterOne
date: 2022-08-22 22:27:42
updated: 2022-08-22 22:27:42
tags: A First Course in ML
categories: MachineLearning
keywords: 
description:
top_img:
comments: true
cover:
toc: true
toc_number: true
copyright_author: Bluet
copyright_author_href:
copyright_url:
copyright_info:
mathjax: true
---

## ***MachineLearning笔记整合***

本笔记主要记录在学习A First Course in Machine Learning这本书时候，一些重要的知识点，形成知识汇总。

### ***写在前面：***

本博客属于个人学习笔记，希望通过文章记录，规范整理自己的学习内容，方便对知识复习和分享。如果有错误的地方，还请指出，同时转载请说明出处，感谢！

---
### 大纲：
1. [概述](#概述 "概述")
2. [线性建模](#线性建模 "线性建模")
    2.1. [什么是线性模型](#什么是线性模型 "什么是线性模型")
    2.2. [什么是损失函数](#什么是损失函数 "什么是损失函数")
    2.3. [对损失函数求偏导](#对损失函数求偏导 "对损失函数求偏导")
    2.4. [二阶导数的意义图解](#二阶导数的意义图解 "二阶导数的意义图解")
    2.5. [$w_0$和$w_1$的二阶导数](#$w_0$和$w_1$的二阶导数 "$w_0$和$w_1$的二阶导数")
3. [预测](#预测 "预测")
4. [向量/矩阵](#向量/矩阵 "向量/矩阵")
    4.1 [矩阵的乘法](#矩阵的乘法 "矩阵的乘法")
5. [例子](#例子 "例子")
	5.1. [数值的例子](#数值的例子 "数值的例子")
6. [线性模型的非线性响应](#线性模型的非线性响应 "线性模型的非线性响应")
7. [泛化和过拟合](#泛化和过拟合 "泛化和过拟合")
	7.1. [验证数据](#验证数据 "验证数据")
	7.1. [交叉验证](#交叉验证 "交叉验证")
8. [正则化最小二乘法](#正则化最小二乘法 "正则化最小二乘法")
9. [后续章节内容预告](#后续章节内容预告 "后续章节内容预告")
10. [引用文献](#引用文献 "引用文献")
## 概述
第一章：线性建模：最小二乘法

### 线性建模

#### 什么是线性模型
定义的模型假设是线性关系 ，好的模型的定义是：一条尽可能与所有数据点接近的直线。
衡量一个特定模型与数据点接近程度的普遍方法是用平方差，预测值和本来值的平方差值。
![20220404-c90356a3](https://www.synotech.top:5523/uploads/2023/04/29/202304291418734.png)

#### 什么是损失函数
这个表达式称为平方损失函数，**squard loss function**。

![20220404-06906ed3](https://www.synotech.top:5523/uploads/2023/04/29/202304291419640.png)

![20220405-998602da](https://www.synotech.top:5523/uploads/2023/04/29/202304291419924.png)
每年的Loss，用平均损失值的方式如上图，求解。

![20220405-4b653a5e](https://www.synotech.top:5523/uploads/2023/04/29/202304291419942.png)
最后我们再用如上图，求解argmin，"找到最小化参数"。平方损失的最小化是函数估计的最小二乘法
的基础。
同时，也有类似绝对损失函数，也可以用来回归，如下：
![20220405-eab99959](https://www.synotech.top:5523/uploads/2023/04/29/202304291420987.png)

#### 对损失函数求偏导

对损失函数求导数，先对 ${w^1}$ ${w^2}$ 分别求偏导数，以及二阶导数
![20220405-41245f4f](https://www.synotech.top:5523/uploads/2023/04/29/202304291420452.png)
$w_1$的偏导数如下：
![20220405-9b2895c7](https://www.synotech.top:5523/uploads/2023/04/29/202304291421776.png)
$w_0$的偏导数如下：
![20220405-7e9d0b45](https://www.synotech.top:5523/uploads/2023/04/29/202304291421103.png)

#### 二阶导数的意义图解

概念：函数梯度 $$f(x)=\frac{P(x)}{Q(x)}$$ 一阶导数为0的点（拐点），但是无法确定是最大还是最小值，
所以还需要求二阶导数。一般的，一个函数可能有多个拐点，如果二阶导数是正的常量，那么这个函数只有一个最小值点。

图解如下：
![20220405-dff73fa3](https://www.synotech.top:5523/uploads/2023/04/29/202304291421101.png)

#### $w_0$和$w_1$的二阶导数

导数等于0，对 $w_0$ 进行求偏导
![20220405-a6a42af7](https://www.synotech.top:5523/uploads/2023/04/29/202304291422108.png)

用这个 $w_0$的表达式，待入到刚才对$w_1$求的偏导数式子中，
![20220405-c075dee1](https://www.synotech.top:5523/uploads/2023/04/29/202304291422420.png)

再定义几个平均量，如下替换后：
![20220405-e2ff73cf](https://www.synotech.top:5523/uploads/2023/04/29/202304291422999.png)

书中，有完整的一个奥运会数据的最小二乘拟合的例子，根据刚才总结出来的公式，求解 $w_0$和 $w_1$，
最后，就能得到拟合最好的线性函数。




### 预测
根据上面，用线性模型拟合一个小数据集产生的结果模型预测未来的结果，还是非常具有局限性，所以需要更加复杂的模型。

如图，生成的男子和女子的奥运会模型，当时间递增的时候，获胜时间，也就是速度越来越快，直到获胜时间为0，那么速度将是无限大，显然，没有这种可能，说明模型的预测是不合理的。

![20220405-34745253](https://www.synotech.top:5523/uploads/2023/04/29/202304291423139.png)


### 向量/矩阵

字母x表示标量，大写X表示矩阵，小写表示向量，$\overline x$表示的是向量x。

#### 矩阵的乘法
矩阵乘法的计算方式如下：
![20220405-a5b9d88a](https://www.synotech.top:5523/uploads/2023/04/29/202304291423499.png)

损失函数的矩阵形式如下：
![20220405-7d662ac4](https://www.synotech.top:5523/uploads/2023/04/29/202304291423152.png) 

乘积的转置
![20220405-f1a06055](https://www.synotech.top:5523/uploads/2023/04/29/202304291423972.png)

乘积转置的化简
![20220405-4225951f](https://www.synotech.top:5523/uploads/2023/04/29/202304291423133.png)

形成 $w_0 w_1$的均值和微分的简洁表示：
![20220405-09163d0e](https://www.synotech.top:5523/uploads/2023/04/29/202304291424504.png)

求得恒等式等于0的表达式：
![20220405-f9890acf](https://www.synotech.top:5523/uploads/2023/04/29/202304291424648.png)

$\hat w$的矩阵公式：
![20220405-cd1519fb](https://www.synotech.top:5523/uploads/2023/04/29/202304291424989.png)例子

二维空间的表达，矩阵公式和之前得到的标量公式一致。
![20220405-48750e2d](https://www.synotech.top:5523/uploads/2023/04/29/202304291425717.png)

重写如下：
![20220405-ed4f3265](https://www.synotech.top:5523/uploads/2023/04/29/202304291425970.png)

计算出，$\hat w$的矩阵表达：
![20220405-83dab511](https://www.synotech.top:5523/uploads/2023/04/29/202304291425421.png) 

$\hat w_1$如下：
![20220405-457455e9](https://www.synotech.top:5523/uploads/2023/04/29/202304291425783.png)

$\hat w_0$
![20220405-f843c893](https://www.synotech.top:5523/uploads/2023/04/29/202304291426193.png)

#### 数值的例子
根据刚才的案例数据，写成矩阵的形式，求解出来的结果和之前一致。
<img src="https://www.synotech.top:5523/uploads/2023/04/29/202304291426002.png" alt="20220405-a067c6cf" style="zoom:80%;" />


### 线性模型的非线性响应
可以根据从参数$w$和$x$的线性关系，增加列$x_n^2$，扩展数据矩阵$X$, 如下：
![20220405-af372d35](https://www.synotech.top:5523/uploads/2023/04/29/202304291426434.png)

同时，加入一个参数$w$,
$w = \begin{bmatrix} w_0\\ w_1\\ w_2 \end{bmatrix}$。

结果如下：
![20220405-410a67fb](https://www.synotech.top:5523/uploads/2023/04/29/202304291427392.png)

添加多个$x$项，形成多项式，能够表达更复杂的函数。
![20220405-40ed843a](https://www.synotech.top:5523/uploads/2023/04/29/202304291427924.png) 
但是，无法预测合理的结果，尤其再观测数据范围之外的。（这里其实就是因为对样本数据已经过拟合了)

###泛化和过拟合

#### 验证数据
验证集用来验证模型的预测性能，数据可以单独提供或者从原始训练数据集种抽出一部分。
训练损失随着多项式阶（模型复杂度）的增加单调递减，然后，验证损失随着阶增加递增。如图所示：
![20220405-dfeec3f1](https://www.synotech.top:5523/uploads/2023/04/29/202304291427081.png) 

泛化能力图解：
![20220405-0abae8b4](https://www.synotech.top:5523/uploads/2023/04/29/202304291428710.png)

#### 交叉验证
因为验证集计算的损失对于验证集数据的选择敏感，所以使用交叉验证的方式，

将数据集分成K等粉数据，K-1份作为训练集，每份单独作为验证集，轮流做验证，最后得出K
个损失值的平均值为最后的损失值。K=N 也就是，每一个观测数据依次作为测试N-1个对象训练
得到的模型，这种特殊情况为留一交叉验证，LOOCV。


因为进行样本次数的验证方式需要耗费大量的时间，所以一般会减少K值，缩放到一个小值。


### 正则化最小二乘法

正则化也能实现避免模型过拟合的功能，在5阶多项式中，w的绝对值的总和越大，则模型的越复杂，我们用 $\sum_{r=1}^n$  $w_i^2$来定义模型的复杂度。

![20220405-e582528a](https://www.synotech.top:5523/uploads/2023/04/29/202304291428689.png) 
之前的Loss函数，夹上一个复杂度惩罚项，再求偏导数，化简得到正则化最小二乘法。
<img src="https://www.synotech.top:5523/uploads/2023/04/29/202304291428739.png" alt="20220405-4a0db26b" style="zoom:80%;" /> 
如下图，当 $\lambda$=0的时候，5阶多项式可以精确地表达6个合成数据点。
![20220405-040bd4c6](https://www.synotech.top:5523/uploads/2023/04/29/202304291428169.png)

$\lambda$值的选择对于过拟合和泛化的折中是一样的，如果值太小，函数就可能很复杂，值
太大，又不利于逼近数据。我们可以使用交叉验证的方式选择最好预测性能的 $\lambda$值。

***
### ***后续章节内容预告***：

***
### 引用文献：
