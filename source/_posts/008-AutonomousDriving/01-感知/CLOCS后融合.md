---
title: CLOCS后融合
comments: true
toc: true
toc_number: true
copyright_author: Bluet
mathjax: 
date: 2023-04-11 00:19:54
updated: 2023-04-11 00:19:54
tags: 后融合
categories: 
- 自动驾驶
- 后融合
keywords:
description:
top_img:
cover:
copyright_author_href:
copyright_url:
copyright_info:

---

## ***CLOCS后融合***

本笔记主要记录在学习阅读CLOCS论文时候，摘录了一些内容汇总。

### ***写在前面：***

本博客属于个人学习笔记，希望通过文章记录，规范整理自己的学习内容，方便对知识复习和分享。如果有错误的地方，还请指出，同时转载请说明出处，感谢！

------

**CLOCS**将3D检测结果和2D检测结果通过一个CLOCS网络进行融合，能提高1-2个AP点，而且可以提高对遮挡物体的召回率。

# 创新点：

1. 使用任何一对预先训练好的2D/3D检测模型，不需要额外的训练，因此可以很容易和任何检测相关的模型适配起来。

1. CLOCs的设计目的是利用二维和三维检测的几何和语义一致性，自动学习训练数据的概率依赖进行融合。

1. CLOCs改进了单模态检测器的检测性能，以达到新的水平



# 主要工作：

将2D/3D的proposals在对应的模态中的confidence score进行关联，使用Geometric-consistency和Semantic-consistency两种约束方式。



## Geometric-consistency

如图所示，当2D/3D检测同时检测到这个物体的时候，都是TP的情况下，我们认为，二维和三维对应的焦点是大概率一致的，或者存在一些小的偏差。但是，如果检测结果是FP，那么两个检测器的结果上焦点是无法对应上的，因此作者任务这种几何结构的一致性可以作为检测结果的联系。

![几何结构的联系](https://www.synotech.top:5523/uploads/2023/04/12/202304122045108.png)



## Semantic consistency

对于每一个模态的检测器，可能存在多种类别的输出，作者在融合阶段仅仅只是对同类别的objects进行融合。



# **网络结构**：

![网络结构](https://www.synotech.top:5523/uploads/2023/04/12/202304122051468.png)

## 三个阶段：

1. 2D和3D的目标检测器分别提出proposals

1. 将两种模态的proposals编码成稀疏张量

1. 对于非空的元素采用二维卷积做对应的特征融合



### 1.张量编码

- 在图像中的第i个检测结果和点云中的第j个的几何一致性（也就是前面提到的Geometric-consistency，这里用IOU表示）

- 图像检测的第i个检测到的物体的置信度分数

- 点云检测第j个检测到的物体的置信度分数

- 点云场景下检测到的第j个物体到地面的归一化距离，**xy plane**

最终将结果通过一个系数的四维张量进行表示，直接输入卷积网络融合。

![四维张量](https://www.synotech.top:5523/uploads/2023/04/12/202304122053850.png)

### 2.实验结果

![实验结果](https://www.synotech.top:5523/uploads/2023/04/12/202304122054004.png)



实际运行的测试情况如下（融合second+cascade-RCNN)：

```shell
2022-09-20 20:53:33,710   INFO  
Car AP@0.70, 0.70, 0.70:
bbox AP:95.6546, 89.7245, 88.7548
bev  AP:89.7622, 87.5664, 85.5937
3d   AP:88.2785, 77.6541, 75.9611
aos  AP:95.61, 89.55, 88.48

Car AP_R40@0.70, 0.70, 0.70:
bbox AP:97.4895, 93.7059, 91.4775
bev  AP:92.5223, 88.3756, 87.3147
3d   AP:88.7911, 79.0908, 76.0444
aos  AP:97.45, 93.48, 91.17

Car AP@0.70, 0.50, 0.50:
bbox AP:95.6546, 89.7245, 88.7548
bev  AP:95.8589, 90.0293, 89.3180
3d   AP:95.8132, 89.9309, 89.1922
aos  AP:95.61, 89.55, 88.48

Car AP_R40@0.70, 0.50, 0.50:
bbox AP:97.4895, 93.7059, 91.4775
bev  AP:97.8720, 94.9669, 94.1804
3d   AP:97.8428, 94.7969, 93.6374
aos  AP:97.45, 93.48, 91.17


```



## 思考

Late-fusion中单模态检测器之间互不干扰的特性做了多种检测器的组合，这种方式可以忽略传感器进行early-fusion时候，找不到匹配的特征或者匹配的维度特征不丰富。

未来可以实现deep-fusion的网络，原因主要是这种融合方式的自由度更大，在特征层的融合可以实现不同传感器信息之间的互补，不采用early-fusion的方式则是因为这种融合方式，在初期阶段会存在更多的视角，特征表示上的差距导致了融合困难。




***

### ***后续章节内容预告***：

***

### 引用文献：

https://arxiv.org/abs/2009.00784
